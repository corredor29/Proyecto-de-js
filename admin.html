<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Admin | El Rinc√≥n del Carmen</title>

  <link rel="stylesheet" href="/css/style.css"/>
  <link rel="stylesheet" href="/css/admin.css"/>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;800;900&family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet"/>

  <script src="/js/app.js" defer></script>
  <script src="/js/auth.js" defer></script>
  <script src="/js/admin.js" defer></script>
</head>
<body class="admin-body">
  <!-- Header -->
  <header class="site-header site-header--admin">
    <div class="container">
      <a class="brand" href="index.html">El Rinc√≥n del Carmen</a>
      <nav class="nav nav--admin">
        <a href="index.html">Inicio</a>
        <a href="reservas.html">Reservas</a>
        <a href="contacto.html">Contacto</a>
        <a href="admin.html" data-active="true">Admin</a>
      </nav>
      <div class="auth">
        <!-- auth.js se encarga de reemplazar este bot√≥n por el mini-men√∫ cuando hay sesi√≥n -->
        <a class="btn btn-login" href="#" id="btnLogin">Iniciar Sesi√≥n</a>
      </div>
    </div>
  </header>

  <!-- Contenido -->
  <main class="admin-wrap container">
    <header class="admin-head">
      <h1>Panel de administraci√≥n</h1>
      <div class="tabs" role="tablist">
        <button class="tab is-active" data-tab="rooms" role="tab" aria-selected="true">Habitaciones</button>
        <button class="tab" data-tab="bookings" role="tab">Reservas</button>
      </div>
    </header>

    <!-- ===== Habitaciones ===== -->
    <section id="tab-rooms" class="admin-tab is-active">
      <div class="bar">
        <div class="filters">
          <select id="fCityRooms" class="adm-select">
            <option value="all">Todas las ciudades</option>
          </select>
          <input id="qRooms" class="adm-input" placeholder="Buscar por nombre/tipo‚Ä¶"/>
        </div>
        <button id="btnNewRoom" class="adm-btn adm-btn--primary">Crear habitaci√≥n</button>
      </div>

      <div class="adm-table-wrap">
        <table class="adm-table" id="roomsTable" aria-label="Habitaciones">
          <thead>
            <tr>
              <th>ID</th>
              <th>Ciudad</th>
              <th>Nombre</th>
              <th>Tipo</th>
              <th>Cap.</th>
              <th>‚≠ê</th>
              <th>m¬≤</th>
              <th>Vista</th>
              <th>Precio /noche</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody><!-- JS --></tbody>
        </table>
      </div>
    </section>

    <!-- ===== Reservas ===== -->
    <section id="tab-bookings" class="admin-tab">
      <div class="bar">
        <div class="filters">
          <select id="fCityBookings" class="adm-select">
            <option value="all">Todas las ciudades</option>
          </select>
          <input id="qBookings" class="adm-input" placeholder="Buscar por hu√©sped/correo‚Ä¶"/>
        </div>
      </div>

      <div class="adm-table-wrap">
        <table class="adm-table" id="bookingsTable" aria-label="Reservas">
          <thead>
            <tr>
              <th>#</th>
              <th>Habitaci√≥n</th>
              <th>Ciudad</th>
              <th>Hu√©sped</th>
              <th>Correo</th>
              <th>Entrada</th>
              <th>Salida</th>
              <th>Noches</th>
              <th>Total</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody><!-- JS --></tbody>
        </table>
      </div>
    </section>
  </main>

  <!-- ===== Modal HABITACI√ìN ===== -->
  <div class="adm-overlay" id="roomOverlay" hidden>
    <section class="adm-modal" role="dialog" aria-modal="true" aria-labelledby="roomModalTitle">
      <header class="adm-modal__head">
        <h3 id="roomModalTitle">Nueva habitaci√≥n</h3>
        <button class="adm-close" data-close>√ó</button>
      </header>

      <form id="roomForm" class="adm-form">
        <input type="hidden" name="id" />
        <div class="grid2">
          <label>Ciudad
            <input name="city" required placeholder="Cartagena, Bogot√°‚Ä¶"/>
          </label>
          <label>Tipo
            <input name="type" required placeholder="Suite, Deluxe‚Ä¶"/>
          </label>
        </div>
        <label>Nombre
          <input name="name" required placeholder="Suite Vista al Mar"/>
        </label>

        <div class="grid4">
          <label>Capacidad
            <input type="number" name="capacity" min="1" required/>
          </label>
          <label>‚≠ê
            <input type="number" name="stars" min="1" max="5" required/>
          </label>
          <label>m¬≤
            <input type="number" name="sizeM2" min="10" required/>
          </label>
          <label>Vista
            <input name="view" required placeholder="Mar, Ciudad‚Ä¶"/>
          </label>
        </div>

        <div class="grid3">
          <label>Precio actual
            <input type="number" name="priceNow" min="0" required/>
          </label>
          <label>Precio anterior
            <input type="number" name="priceOld" min="0" required/>
          </label>
          <label>Imagen (URL)
            <input name="image" placeholder="/image/habitacion1.jpg"/>
          </label>
        </div>

        <fieldset class="feat">
          <legend>Caracter√≠sticas</legend>
          <label><input type="number" name="beds" min="1" value="1"/> Camas</label>
          <label><input type="checkbox" name="wifi"/> Wi-Fi</label>
          <label><input type="checkbox" name="minibar"/> Minibar</label>
          <label><input type="checkbox" name="hotTub"/> Jacuzzi</label>
          <label><input type="checkbox" name="balcony"/> Balc√≥n</label>
          <label><input type="checkbox" name="ac"/> A/A</label>
          <label><input type="checkbox" name="breakfast"/> Desayuno</label>
        </fieldset>

        <footer class="adm-modal__foot">
          <button type="button" class="adm-btn" data-close>Cancelar</button>
          <button type="submit" class="adm-btn adm-btn--primary">Guardar</button>
        </footer>
      </form>
    </section>
  </div>

  <!-- ===== Modal EDITAR RESERVA ===== -->
  <div class="adm-overlay" id="bookingOverlay" hidden>
    <section class="adm-modal" role="dialog" aria-modal="true" aria-labelledby="bookingModalTitle">
      <header class="adm-modal__head">
        <h3 id="bookingModalTitle">Editar reserva</h3>
        <button class="adm-close" data-close>√ó</button>
      </header>

      <form id="bookingForm" class="adm-form">
        <input type="hidden" name="id"/>
        <label>Habitaci√≥n
          <select name="roomId" id="bkRoomId"></select>
        </label>
        <div class="grid3">
          <label>Entrada
            <input type="date" name="start" required/>
          </label>
          <label>Salida
            <input type="date" name="end" required/>
          </label>
          <label>Hu√©spedes
            <input type="number" name="guests" min="1" required/>
          </label>
        </div>
        <footer class="adm-modal__foot">
          <button type="button" class="adm-btn" data-close>Cancelar</button>
          <button type="submit" class="adm-btn adm-btn--primary">Guardar</button>
        </footer>
      </form>
    </section>
  </div>

  <!-- ===== Modal de autenticaci√≥n (necesario para abrir login desde el guard) ===== -->
  <div class="luxe-auth" id="luxeAuth" aria-hidden="true">
    <div class="luxe-auth__overlay" data-close></div>
    <section class="luxe-auth__card" role="dialog" aria-modal="true" aria-labelledby="luxeAuthTitle">
      <aside class="luxe-auth__side" aria-hidden="true">
        <div class="luxe-auth__brand">
          <span class="luxe-auth__logo">RC</span>
          <strong>El Rinc√≥n del Carmen</strong>
        </div>
        <p class="luxe-auth__tag">Hospitalidad de autor</p>
      </aside>
      <div class="luxe-auth__panel">
        <header class="luxe-auth__head">
          <h2 id="luxeAuthTitle" class="luxe-auth__title">
            <span class="state-login">Iniciar sesi√≥n</span>
            <span class="state-register">Crear cuenta</span>
          </h2>
          <button class="luxe-auth__close" data-close aria-label="Cerrar">√ó</button>
        </header>

        <!-- Login -->
        <form id="luxeLogin" class="luxe-form state-login" novalidate>
          <label class="luxe-field">
            <span>Correo electr√≥nico</span>
            <input type="email" name="email" placeholder="tucorreo@dominio.com" required>
          </label>
          <label class="luxe-field">
            <span>Contrase√±a</span>
            <div class="luxe-pass">
              <input type="password" name="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
              <button class="luxe-eye" type="button" aria-label="Mostrar/ocultar contrase√±a">üëÅ</button>
            </div>
          </label>
          <div class="luxe-row">
            <label class="luxe-check"><input type="checkbox" name="remember"><span>Recu√©rdame</span></label>
            <a href="#" class="luxe-link" id="luxeForgot">¬øOlvidaste tu contrase√±a?</a>
          </div>
          <button class="luxe-btn luxe-btn--primary" type="submit">Entrar</button>
          <p class="luxe-swap">¬øNo tienes cuenta?
            <button class="luxe-link-btn" type="button" id="goRegister">Crear cuenta</button>
          </p>
          <p class="luxe-msg" id="luxeLoginMsg" role="status" aria-live="polite"></p>
        </form>

        <!-- Registro -->
        <form id="luxeRegister" class="luxe-form state-register" novalidate>
          <label class="luxe-field"><span>Nombre</span>
            <input type="text" name="name" placeholder="Tu nombre" required>
          </label>
          <label class="luxe-field"><span>Correo electr√≥nico</span>
            <input type="email" name="email" placeholder="tucorreo@dominio.com" required>
          </label>
          <label class="luxe-field"><span>Contrase√±a</span>
            <div class="luxe-pass">
              <input type="password" name="password" minlength="6" placeholder="M√≠nimo 6 caracteres" required>
              <button class="luxe-eye" type="button" aria-label="Mostrar/ocultar contrase√±a">üëÅ</button>
            </div>
          </label>

          <div class="pw-widget" id="pwWidget">
            <div class="pw-lock" aria-hidden="true">
              <svg class="ring" viewBox="0 0 52 52" width="52" height="52">
                <circle class="bg" cx="26" cy="26" r="18"></circle>
                <circle class="prog" cx="26" cy="26" r="18"></circle>
              </svg>
              <span class="icon">üîí</span>
            </div>
            <div class="pw-label" id="pwLabel">Seguridad: ‚Äî</div>
            <div class="pw-meter"><div class="fill" id="pwFill"></div></div>
            <ul class="pw-tips" id="pwTips">
              <li data-k="len">6+ caracteres</li>
              <li data-k="uc">May√∫scula</li>
              <li data-k="lc">Min√∫scula</li>
              <li data-k="num">N√∫mero</li>
              <li data-k="sym">S√≠mbolo</li>
            </ul>
          </div>

          <label class="luxe-check"><input type="checkbox" name="terms" required><span>Acepto los t√©rminos y condiciones</span></label>
          <button class="luxe-btn luxe-btn--primary" type="submit">Registrarme</button>
          <p class="luxe-swap">¬øYa tienes cuenta?
            <button class="luxe-link-btn" type="button" id="goLogin">Iniciar sesi√≥n</button>
          </p>
          <p class="luxe-msg" id="luxeRegMsg" role="status" aria-live="polite"></p>
        </form>
      </div>
    </section>
  </div>

  <!-- Guardia de acceso admin -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Llama a la funci√≥n nueva del auth para proteger esta p√°gina
      window.ErcAuth?.ensureAdminPage?.();
    });
  </script>
</body>
</html>
